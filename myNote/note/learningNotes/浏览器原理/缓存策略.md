# 缓存策略

通过浏览器缓存，可以减少浏览器向服务器发起的重复资源请求，减轻服务器性能开销；

但当缓存资源过期时（服务器相应资源发生改变），浏览器应该重新发起请求，而不是又从缓存区获取数据；

针对该问题的处理策略，即浏览器缓存**策略**，有两种：强缓存和协商缓存；

两种缓存策略都是通过设置HTTP Header来实现



## 强缓存

由浏览器确定缓存是否可用，不会向服务器发送请求；

两种设置方式：（cache-control优先级高于expires）

- **expires** 指定缓存过期**日期**，受限于本地时间，修改本地时间可导致缓存失效

- **Cache-Control** 单向的消息头字段，使用多个指令可用逗号分隔：

  - max-age=< seconds > 指定过期**持续时间**，该时间内请求强制走缓存
  - s-maxage=< seconds> 覆盖max-age或expires ，仅用于共享缓存
  - no-store 不存储任何缓存，即不使用任何缓存
  - no-cache 绕开强缓存，让服务器验证请求（走协商缓存）
  - ...

  





## 协商缓存

浏览器携带缓冲标识发起请求，由服务器决定是否使用缓存；

同样有两种方式：（ETag优先级高于Last-Modified）

- **Last-Modified** 一个响应头部字段，记录该响应文件的最后修改**日期时间**（最多精确到秒）。浏览器第二次请求该文件时，会在**请求头**用字段**If-Modified-Since**带上该值，服务器收到和自己最后修改时间对比，超过该时间即文件发生变化，返回新资源，否则返回304；
- **ETag** 响应头字段，记录一个服务器根据资源生成的**hash值或版本号**。下次请求时，**请求头**使用**If-None-Match**字段携带该值，服务器进行匹配；不一样返回新内容，一样返回304通知浏览器使用缓存；







参考：

> [浏览器缓存策略(强缓存和协商缓存) - 掘金 (juejin.cn)](https://juejin.cn/post/7030697010655297572)
>
> 